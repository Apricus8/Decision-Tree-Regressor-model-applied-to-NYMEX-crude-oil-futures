# Decision-Tree-Regressor-model-applied-to-NYMEX-crude-oil-futures
The code performs a walk-forward cross-validation with purging and embargo using a Decision Tree regression model to predict crude oil closing prices.

Here's a description of the code:

The necessary libraries are imported: pandas for data manipulation, numpy for numerical operations, matplotlib.pyplot for data visualization, and various modules from scikit-learn for data preprocessing, model training, and evaluation.

The historical price data is loaded from the provided URL using pandas' read_csv function. The 'Date' column is converted to a datetime type and set as the index.

The closing prices are extracted from the dataset and stored in the closing_prices variable.

The closing prices are normalized using the MinMaxScaler from scikit-learn, which scales the prices between 0 and 1.

The create_dataset function is defined, which takes a time series data and a window size as input and creates a dataset for training and testing by splitting the data into input sequences (X) and corresponding target values (y).

The window size for the time series data is set to 30.

The TimeSeriesSplit from scikit-learn is used to perform walk-forward cross-validation with purging and embargo. It splits the dataset into training and testing sets in a time-ordered manner, considering the purging and embargo periods.

Empty lists are created to store the evaluation metrics for each fold of the cross-validation.

A figure and axes are created using plt.subplots to visualize the performance using a single line plot.

The loop iterates over the splits generated by the TimeSeriesSplit, and for the first fold, it performs the following steps:
a. The training and testing datasets are created by applying purging and embargo to the normalized closing prices.
b. The training dataset is transformed into input sequences (X_train) and target values (y_train).
c. The testing dataset is transformed into input sequences (X_test) and target values (y_test).
d. A Decision Tree regression model is created and trained on the training dataset.
e. Predictions are made on the testing dataset using the trained model.
f. The predicted and actual closing prices are denormalized using the scaler.
g. Evaluation metrics such as RMSE, MAE, R2 score, MSLE, MPE, MAPE, and explained variance score are calculated.
h. The actual and predicted closing prices for the first fold are plotted on the axes.

The plot labels and title are set.

The plot is displayed using plt.show().

The average scores across all the cross-validation folds are calculated using numpy's mean function.

The average scores are printed.

The code performs a walk-forward cross-validation with purging and embargo using a Decision Tree regression model to predict the closing prices. It visualizes the performance by plotting one actual closing price and one predicted closing price on a single line plot. The average evaluation metrics across all the folds are also calculated and printed.
